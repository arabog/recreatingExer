<!DOCTYPE html>
<html lang="en">
<head>
          <meta charset="UTF-8">
          <meta http-equiv="X-UA-Compatible" content="IE=edge">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
          <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>

          <script src="https://unpkg.com/@babel/standalone@7.8.3/babel.js"></script>

          <title>Lang</title>
</head>
<body>
          <div id="root"></div>
          
          <script>
                    window.API = {
                              popularRepo(language) {
                                        const fetchRepo = encodeURI(`https://api.github.com/search/repositories?q=stars:>1+language:${language}&sort=stars&order=desc&type=Repositories`)

                                        fetch(fetchRepo)
                                                  .then(res => res.json)
                                                  .then(data => data.items)

                                                  .catch(err => {
                                                            console.warn(err);
                                                  })
                              }

                    }
          </script>

          <script type = "text/babel">
                    class LoadPage extends React.Component {
                              constructor(props) {
                                        super(props);
                                        this.state = { 
                                                  startingPg: 'Welcome'
                                        }
                              }
                              
                              componentDidMount(){
                                        let nextText = this.state.startingPg + '. . . . . '

                                        this.timer = window.setInterval(() => {
                                                  this.state.startingPg === nextText
                                                            ? this.setState(()=> {
                                                                      return (
                                                                                {
                                                                                          startingPg: "Here Comes the Homepage"
                                                                                }
                                                                      )
                                                            })
                                                            : this.setState((nee) => {
                                                                      return(
                                                                                {
                                                                                          startingPg: nee.startingPg + ": nothing to display"
                                                                                }
                                                                      )
                                                            })
                                        }, 300)
                              }
                              
                              componentWillUnmount() {
                                        clearInterval(this.timer)
                              }

                              render() { 
                                        return ( 
                                                  <div>
                                                            {this.state.startingPg}
                                                  </div>
                                        );
                              }
                    }
                    
                    class Nav extends React.Component {
                              constructor(props) {
                                        super(props);
                                        this.state = {  }
                              }
                              render() { 
                                        let languages = ['All', 'JavaScript', 'Python', 'Ruby']

                                        return ( 
                                                  <div>
                                                            <ul>
                                                                      {
                                                                                languages.map(lang => (
                                                                                          <li>
                                                                                                    {lang}          
                                                                                          </li>
                                                                                ))          
                                                                      }
                                                            </ul>
                                                  </div>
                                         );
                              }
                    }
                     
                    class CodingLang extends React.Component {
                              constructor(props) {
                                        super(props);

                                        this.state = {
                                                  repos: [],
                                                  langToDisplay: 'all',
                                                  startingPgStillLoading: true
                                        }
                              }

 // consume d api
                              fetchGivenRepo(arg) {
                                        // maintain d startingPgStillLoading
                                        this.setState(()=> {
                                                  return (
                                                            {
                                                                      startingPgStillLoading: true
                                                            }
                                                  )
                                        })

                                        // declare a method 4 d api
                                        window.API.popularRepo(arg)
                                                  .then(info => {
                                                            this.setState(() => {
                                                                      return(
                                                                                {
                                                                                          startingPgStillLoading: false,
                                                                                          repos: info
                                                                                }
                                                                      )
                                                            })
                                                  })
                              }
                              
                                      componentDidMount() {
                                        return fetchGivenRepo(argumt)
                              }

                              componentDidUpdate(prevProp, prevState){
                                        if(prevState.langToDisplay !== this.state.langToDisplay) {
                                                  return fetchGivenRepo(this.state.langToDisplay)
                                        }
                              }
                              
                              
                              render() { 
                                        return ( 
                                                  <div>
                                                            <Nav />
                                                  </div>
                                         );
                              }
                    }
                              
                    ReactDOM.render(
                              <CodingLang />,
                              document.getElementById('root')
                    )
          </script>


</body>
</html>
